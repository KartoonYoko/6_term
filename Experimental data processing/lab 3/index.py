import matplotlib.pyplot as plt
import math


# variant 17

# –¶ –µ –ª —å —Ä –∞ –± –æ —Ç —ã: –æ–≤–ª–∞–¥–µ–Ω–∏–µ —Å–ø–æ—Å–æ–±–∞–º–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –Ω–µ—Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
# –¥–∞–Ω–Ω—ã—Ö, –≤—ã—Ä–∞–±–æ—Ç–∫–∞ —É–º–µ–Ω–∏—è –∏ –Ω–∞–≤—ã–∫–æ–≤ –æ—Ü–µ–Ω–∫–∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏, —É—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∏ –µ–≥–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤.
# –° –æ –¥ –µ —Ä –∂ –∞ –Ω –∏ –µ  –∞ –± –æ —Ç —ã: –Ω–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ –æ–ø—ã—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Ç—Ä–µ–±—É–µ—Ç—Å—è:
#  –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–µ –ø–æ–ª–µ. –ü–æ —Ö–∞—Ä–∞–∫—Ç–µ—Ä—É —Ä–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏—è —Ç–æ—á–µ–∫ –≤ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–æ–º –ø–æ–ª–µ –≤—ã–±—Ä–∞—Ç—å
#  –æ–±—â–∏–π –≤–∏–¥ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏.
# 2. –í—ã—á–∏—Å–ª–∏—Ç—å —á–∏—Å–ª–æ–≤—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ "x" ¬†ÃÖ, "y" ¬†ÃÖ, „Äñ" S" „Äó_"x" , "S" _"y" , r, ùúé_"r" .
# 3. –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ r –∏ –Ω–∞–π—Ç–∏ –¥–ª—è –Ω–µ–≥–æ –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª —Å –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å—é …£=0,95.
# 4. –ù–∞–ø–∏—Å–∞—Ç—å —ç–º–ø–∏—Ä–∏—á–µ—Å–∫–∏–µ —É—Ä–∞–≤–Ω–µ–Ω–∏—è –ª–∏–Ω–∏–π —Ä–µ–≥—Ä–µ—Å—Å–∏–π y –Ω–∞ x –∏ x–Ω–∞ y.
# 5. –í—ã—á–∏—Å–ª–∏—Ç—å –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏ "R" ^2 –∏ –æ–±—ä—è—Å–Ω–∏—Ç—å –µ–≥–æ —Å–º—ã—Å–ª–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ.
# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ y –Ω–∞ x
# 7. –ü—Ä–æ–≤–µ—Å—Ç–∏ –æ—Ü–µ–Ω–∫—É –≤–µ–ª–∏—á–∏–Ω—ã –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ y
# –Ω–∞ x –∏ –µ–≥–æ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤.
# 8. –ü–æ—Å—Ç—Ä–æ–∏—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ y –Ω–∞ x –≤ –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç.

# –§–∞–∑–æ–≤–∞—è –ø—Ä–æ–Ω–∏—Ü–∞–µ–º–æ—Å—Ç—å –Ω–µ—Ñ—Ç–∏ –∏ –Ω–∞—Å—ã—â–µ–Ω–Ω–æ—Å—Ç—å –ø–æ—Ä–æ–¥—ã –Ω–µ—Ñ—Ç—å—é
# –• —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏–∑—É–µ—Ç—Å—è —Å–ª–µ–¥—É—é—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏:
# X 0.05 0.15 0.25 0.35 0.45 0.55 0.65 0.75 0.85 0.95
# Y 0.35 0.45 0.55 0.65 0.75 0.80 0.85 0.95 1.00 1.25

x_arr = [0.05, 0.15, 0.25, 0.35, 0.45, 0.55, 0.65, 0.75, 0.85, 0.95]
y_arr = [0.35, 0.45, 0.55, 0.65, 0.75, 0.80, 0.85, 0.95, 1.00, 1.25]

# —Å—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ X Y
x_average = sum(x_arr) / len(x_arr)
y_average = sum(y_arr) / len(y_arr)

# —Ä–∞—Å—á–µ—Ç S^2x S^2y –≤—ã–±–æ—Ä–æ—á–Ω—ã–µ —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—ã–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
s2x = 0
s2y = 0
for i in range(len(x_arr)):
    s2x += (x_arr[i] - x_average) ** 2
    s2y += (y_arr[i] - y_average) ** 2
s2x /= len(x_arr) - 1
s2y /= len(y_arr) - 1
sx = math.sqrt(s2x)
sy = math.sqrt(s2y)

# —Ä–∞—Å—á–µ—Ç xy- r
xy_average = 0
for i in range(len(x_arr)):
    xy_average += x_arr[i] * y_arr[i]
xy_average /= len(x_arr)
r = round((xy_average - x_average * y_average) / (sx * sy), 3)      # –∫–æ—ç—Ñ –ª–∏–Ω–µ–π–Ω–æ–π –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏

# –ø—Ä–æ–≤–µ—Ä—è–µ–º –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –∫–æ—ç—Ñ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏
print("–ø—Ä–æ–≤–µ—Ä—è–µ–º –∑–Ω–∞—á–∏–º–æ—Å—Ç—å –∫–æ—ç—Ñ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏: ")
tp = round((math.fabs(r) * math.sqrt(len(x_arr) - 2)) / math.sqrt(1 - r ** 2), 2)
print("tp = ", tp , "t = 2.31")

# –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–ª—è –≤—ã–±–æ—Ä–æ—á–Ω–æ–≥–æ –∫–æ—ç—Ñ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ r
# —Å –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å—é y = 0.95 –ø–æ—ç—Ç–æ–º—É –ø–æ —Ç–∞–±–ª–∏—Ü–µ —Ñ—É–Ω–∫—Ü–∏–∏ –õ–∞–ø–ª–∞—Å–∞
# –Ω–∞—Ö–æ–¥–∏–º ty = 1.96
ty = 1.96
# —Å—Ä–µ–¥–Ω—è—è –∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞
error_aver = round((1 - r ** 2) / (len(x_arr) - 2), 3)
# –¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª —Ç–æ–≥–¥–∞
print("–¥–æ–≤–µ—Ä–∏—Ç–µ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª: ")
print(r - ty * error_aver, "<= r^ >=", r + ty * error_aver,)

# —É—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–µ–≥—Ä–µ—Å—Å–∏–π
print("—É—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–µ–≥—Ä–µ—Å—Å–∏–π: ")
y_reg = complex(round(y_average - x_average * r * sy / sx, 5), round(r * sy / sx, 5))
x_reg = complex(round(x_average - y_average * r * sx / sy, 5), round(r * sx / sy, 5))
print("y^x = ", y_reg)
print("x^y = ", x_reg)
print("–ö–æ–Ω—Ç—Ä–æ–ª—å –≤—ã—á–µ—Å–ª–µ–Ω–∏–π: ")
print(round(y_reg.imag * x_reg.imag, 6))
print(r ** 2)
# –õ–∏–Ω–µ–π–Ω—ã–µ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
yx_arr = []
xy_arr = []
for i in range(len(x_arr)):
    yx_arr.append(round(y_reg.real + y_reg.imag * x_arr[i], 4))
    xy_arr.append(round(x_reg.real + x_reg.imag * y_arr[i], 4))

# –∫–æ—ç—Ñ –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏
print("–∫–æ—ç—Ñ –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏: ")
print(r ** 2)

# –ø—Ä–æ–≤–µ—Ä–∏–º –∞–¥–µ–∫–≤–∞—Ç–Ω–æ—Å—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏—è –ª–∏–Ω–µ–π–Ω–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
# y –Ω–∞ x –ø–æ –∫—Ä–∏—Ç–µ—Ä–∏—é –§–ò—à–µ—Ä–∞-–°–Ω–µ–¥–µ–∫–æ—Ä–∞
sum1 = 0
sum2 = 0
u_arr = []
for i in range(len(x_arr)):
    u_arr.append((y_arr[i] - yx_arr[i]))
    sum1 += (y_arr[i] - yx_arr[i]) ** 2
    sum2 += (y_arr[i] - y_average) ** 2
u_average = sum1 / len(x_arr)
R2 = 1 - sum1 / sum2
Fh = round(R2 * (len(x_arr) - 2) / (1 - R2), 3)
print("FH = ", Fh, "FT = 5.32")

# –ø—Ä–æ–≤–µ–¥–µ–º –æ—Ü–µ–Ω–∫—É –≤–µ–ª–∏—á–∏–Ω—ã –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç–∏ —É—Ä–∞–≤–Ω–µ–Ω–∏—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ y_reg
# –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å
u_average = sum1 / len(x_arr)
sum3 = 0
for i in range(len(x_arr)):
    sum3 += (u_arr[i] - u_average) ** 2
du = round(math.sqrt(sum3 / (len(x_arr) - 2)), 3)
print("du = ", du)
print("–û—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–∞—è –ø–æ–≥—Ä–µ—à–Ω–æ—Å—Ç—å —É—Ä–∞–≤–Ω–µ–Ω–∏—è y_reg: ", round(du / y_average * 100, 2), "%")

# –æ—Ü–µ–Ω–∫–∞ –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ —Ä–µ–≥—Ä–µ—Å—Å–∏–∏
sum3 = 0
for i in range(len(x_arr)):
    sum3 += x_arr[i] ** 2
Syx = sy * math.sqrt(1 - r ** 2)
Sa1 = round(Syx * math.sqrt(len(x_arr) / (len(x_arr) * sum3 - sum(x_arr) ** 2)), 3)
Sa0 = round(Syx * math.sqrt(sum3 / (len(x_arr) * sum3 - sum(x_arr) ** 2)), 3)
print("Sa1 / |a1| = ", Sa1 / math.fabs(y_reg.imag))
print("Sa0 / |a0| = ", Sa0 / math.fabs(y_reg.real))

plt.plot(x_arr, y_arr, 'ro', color="gray", label="–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –Ω–∞–±–ª—é–¥–µ–Ω–∏–π")
plt.plot(x_arr, yx_arr, color="blue", label="–õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è x –Ω–∞ y")
plt.plot(xy_arr, y_arr, color="red", label="–õ–∏–Ω–µ–π–Ω–∞—è —Ä–µ–≥—Ä–µ—Å—Å–∏—è y –Ω–∞ x")
plt.xlabel('X')
plt.ylabel('Y')
plt.title('–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω–∞—è –ø–ª–æ—Å–∫–æ—Å—Ç—å')
plt.legend()
plt.grid()      # –≤–∫–ª—é—á–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–µ—Ç–∫–∏
plt.show()


